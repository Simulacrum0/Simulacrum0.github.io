<!-- ====================================================================== -->
<!-- Ku00 ToKzYa -->
<!-- ====================================================================== -->
<!DOCTYPE html>
<html>

<head>
    <!-- CORE -->
    <title>PowerOurPeople: LabEast Wantware</title>
    <link rel="shortcut icon" type="image/png" href="Mx01__SuKz_MEDIA/SuKz07_DryDz__BIZ/DryDzGwz05__THINKER.png" />
    <link rel="canonical" href="https://powerourpeople.com" />

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow">
	<link rel="manifest" href="manifest.json" />

    <!-- OPEN_GRAPH: Social Media Finder -->
    <meta property="og:title" content="Power Our People Website" />
    <meta property="og:description" content="Learn more about Wantware and empowering the 99% of the world that does not program" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://powerourpeople.com" />
    <meta property="og:image" content="http://powerourpeople.com/Mx01__SuKz_MEDIA/SuKz07_DryDz__BIZ/DryDzGwz05__THINKER.png" />

    <!-- STYLE & MEDIA -->
    <!-- <link rel="stylesheet" href="Mx07__SuSmi_WEBPG/SuSmi02__CSS/JoDx00__Do.css"> -->

    <!-- SCRIPTS -->
    <!-- <script defer src="Mx07__SuSmi_WEBPG/SuSmi01__JS/JiJa00__HEXCIRC.js"></script>
		<script defer src="Mx07__SuSmi_WEBPG/SuSmi01__JS/JiJa01__DROPZ.js"></script>
		<script defer src="Mx07__SuSmi_WEBPG/SuSmi01__JS/JiJa02__PLAZ.js"></script>
		<script defer src="Mx07__SuSmi_WEBPG/SuSmi01__JS/JiJa03__ETHER.js"></script>

		<script defer src="Mx07__SuSmi_WEBPG/SuSmi01__JS/JiJa04__AURORA.js"></script>
		<script defer src="Mx07__SuSmi_WEBPG/SuSmi01__JS/JiJa05__HEXSCROLL.js"></script>
		<script defer src="Mx07__SuSmi_WEBPG/SuSmi01__JS/JiJa06__SUNRISE.js"></script>
		<script defer src="Mx07__SuSmi_WEBPG/SuSmi01__JS/JiJa07__CODEX.js"></script> -->

    <script src="Mx07__SuSmi_WEBPG/SuSmi01__JS/Ki00__PUB.js"></script>
    <!-- <script src="Mx07__SuSmi_WEBPG/SuSmi01__JS/Ki01__CORE.js"></script> -->
    <!-- <script src="Mx07__SuSmi_WEBPG/SuSmi01__JS/Ki02__LANG.js"></script> -->
    <!-- <script src="Mx07__SuSmi_WEBPG/SuSmi01__JS/Ki03__CFG.js"></script> -->

    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.4.4/build/qrcode.min.js"></script>

    <script src="Mx07__SuSmi_WEBPG/SuSmi01__JS/Kru05__Hra4_Bru00__SyDe.js" type="application/javascript"></script>
    <!-- <script src="Mx07__SuSmi_WEBPG/SuSmi01__JS/Kru05__Hra4_Bru00__SyZx.js" type="application/javascript"></script> -->
    <!-- <script src="Mx07__SuSmi_WEBPG/SuSmi01__JS/Kru05__Hra4_Bru01__Tra.js" type="application/javascript"></script> -->

    <script src="Mx07__SuSmi_WEBPG/SuSmi01__JS/Kru00__Hrz4_Bu.js" type="application/javascript"></script>

</head>


<!-- AUDIO -->
<audio id="ToMi_JaPe">
	<!-- <source src="Mx01__SuKz_MEDIA/SuKz01_JaPe__SND/PeJo04__JeMx_BEEP.mp3" type="audio/mp3"> -->
	<source src="Mx01__SuKz_MEDIA/SuKz01_JaPe__SND/JaPe00__ToMi.wav" type="audio/wav">
	WARNING Your browser does not support the audio element.
</audio>


<!-- ====================================================================== -->
<!-- Ku01 STYLE
	<!-- ====================================================================== -->
<style>
    *
    {
        box-sizing: border-box;
    }

    html
    {
        margin: 0;
        padding: 0;
        color: #000;
		font-family: Arial, Helvetica, sans-serif;
    }

    body
    {
        background-color: #EE6;

        font-size: 1.0em;
        text-align: center;
        margin: auto;
        padding: 1.0em;

        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }

    h1
    {
        font-family: Impact, sans-serif;
        text-align: center;
    }
    h2
    {
        text-align: center;
    }


    input, textarea
    {
        background-color: #00F;
        color: #EE6;
        border-style: groove;

        word-wrap: normal;
        white-space: pre-wrap;

        text-align: center;
		resize: none;

		font-size: 1.5em;
		font: Arial, sans-serif;
    }

    button
    {
        border-radius: 16px;
        background-color: #F22;
        color: white;

        border: none;
        padding: 0.5em 0.5em;
        margin: 0.2em 0.2em;

        font-size: 1.25em;

		touch-action: manipulation;
    }

    button:hover
    {
        color: #F22;
        background-color: white;
		font: italic sans-serif;
    }

    /* unvisited link */
    a:link
    {
        color: #FFF;
    }

    /* visited link */
    a:visited
    {
        color: #DDD;
    }

    /* mouse over link */
    a:hover
    {
        color: #BBF;
    }

    /* selected link */
    a:active
    {
        color: #FFB;
    }

	ul
	{
		 list-style-type: none;
		margin: 0; /* Remove default margins */
		padding: 0; /* Remove default padding */
	}


    li
    {
		line-height: 1.0em;
	    font: italic 1.0em sans-serif;
		padding: 0px;
		margin: 0px 0px 0px 0px;
		margin-bottom: 0px; /* Control space between items */

		text-indent: -0.9rem;
    }

  li::before
  {
    content: "➡️ ";
  }

    .BUF
    {
        background-color: #FFF;
        color: #00A;
        width: 100%;
		height: 16em;
        padding: 1.0 em;
        margin: 1.0 em;

        border-color: #00F;
        border-radius: 2px;
        border-style: groove;

        text-align: left;

        word-wrap: break-word;
		overflow-y: scroll;
        white-space: pre-wrap;
        line-height: 1.0em;

        font-size: 1.0em;
    }

    .BOX
    {
        border-color: #DD5;
        border-radius: 32px;
        border-style: double;
        border-width: 8px;
        padding: 1em 1em;
    }

	.CTRL_LBL
	{
        color: #F22;
        background-color: white;
		font: bold sans-serif;
	}

	.CTRL_BOX
    {
        border-color: #DD5;
        border-radius: 4px;
        border-style: dashed;
        border-width: 4px;
        padding: 0.5em;

		position: relative;
		display: block;
		width: fit-content;
    }

	#SF_KuGwy, #SF_KuSe
	{
        border-color: #00F;
        border-radius: 2px;
        border-style: groove;

        padding: 0em 0em;

		width: calc(100% - 0.5em );
	}

    #content
    {
        text-align: center;
        display: flex;
        flex-direction: column;
        padding: 10px;
        margin: 0 auto;

        min-width: 256px;
        max-width: 1280px;
        width: calc(100% - 0.5em );
    }


    #content
    {
        /* max-width: 800px; */
        min-height: 100%;
        justify-content: center;
    }

    #content .textual
    {
        color: #DDD;
    }

    #content .textual
    {
        font-size: 1em;
    }

    #content a:visited
    {
        color: #FF7700;
    }

    #content a
    {
        color: #0077FF;
    }


    #rc-demo
    {
        display: flex;
        flex-direction: column;
        margin: auto;
		width: calc(100% - 0.5em );
    }

    #rc-demo button
    {
        border: none;
        cursor: pointer;
    }

    #rc-demo .color
    {
        max-width: 20px;
        width: 20px;
        height: 20px;
        position: relative;
    }

    #rc-demo canvas
    {
        image-rendering: auto;
        /* width: fit-content; */
		width: calc(100% - 0.5em );
    }

    #rc-demo .erase
    {
        position: absolute;
        top: 2px;
        left: 2px;
		font-size: 0.75em;
    }

    #rc-demo .arrow
    {
        border: none;
        position: absolute;
        top: -24px;
        left: 0px;
        cursor: auto;
        color: white;
    }

    #rc-demo .hidden
    {
        display: none;
	}

</style>


<!-- ====================================================================== -->
<!-- Ku01 BODY Bz
<!-- ====================================================================== -->

<body>
	<div>
		<img style="position:absolute; left: 1em;" width="96px"; src="Mx01__SuKz_MEDIA/SuKz07_DryDz__BIZ/DryDzGwz05__THINKER.png"></img>
		<h1  id="VyBzVa">SELF_SERV v</h1>
	</div>
	<br>
	<br>

    <div class="BOX" style="display: none;">
    <!-- <div class="BOX"> -->
        <h2 id="DuKu_VaSy">#1 JOIN</h2>

        <h3>People in Room: <span id="KeDyCha">no</span></h3>
        <h3>Your Name:</h3>
        <input id="SaNo_VaSy" maxlength="63" value="?" style="width: 50%;" />
        <br><br>
        <button id="SaNo_VaSy_Tra" onclick="Mx_SaNo_VaSy();" >Sync Name</button>
        <button id="SaNoKu_ChxGry" onclick="localStorage.clear(); ">Erase History</button>
        <br>
        <br>
        <div id="QRDiv"></div>
        <br>
        <button id="Me_CLIP">Copy</button>
        <button id="Me_EMAIL">Email </button>
        <button id="Me_SMS">Txt</button>
        <button id="Me_URL_ROOM"><a href="WzFe.html" target="_NEW">New Room</a></button>
        <button id="Me_SHARE">Share</button>
    </div>
    <br>
    <br>

    <div id="TaKeDruGry" class="BOX" style="display: none;" >
		<!-- <div id="TaKeDruGry" class="BOX" > -->
        <h2>#2 MESSAGES</h2>
        <h3>Your Message:</h3>
        <textarea id="SaNo_MeKz" rows="4" columns="32" style="width: 75%;" /></textarea>
        <br>
        <br>
        <button id="MeKeDru_Gry" onclick="Mx_SaNo_MeKz( -1 );" >Send All</button>
        <button style="display: none;" id="MeKeDru_0" onclick="Mx_SaNo_MeKz( 0 );" >Send 0</button>
        <button style="display: none;" id="MeKeDru_1" onclick="Mx_SaNo_MeKz( 1 );" >Send 1</button>
        <button style="display: none;" id="MeKeDru_2" onclick="Mx_SaNo_MeKz( 2 );" >Send 2</button>
        <button style="display: none;" id="MeKeDru_3" onclick="Mx_SaNo_MeKz( 3 );" >Send 3</button>
        <br>
        <h3>Message History:</h3>
        <div id="TaKeDru_Ku" class="BUF"></div>
    </div>
    <br>
    <br>

    <div class="BOX" style="display: none;" >
    <!-- <div class="BOX" > -->
        <h2>#3 MAP_MAKER</h2>


        <div id="content">
            <div id="rc-demo">
                <div id="outer-container">
                    <div style="display: flex; align-items: center; gap: 4px">
                        <label for="enable-srgb">Brighten</label>
                        <input type="checkbox" id="enable-srgb" checked>
                    </div>
                </div>

                <details style="cursor: pointer; display: none;">
                    <summary>GFX_Tweaks</summary>

                    <div style="display: none; align-items: center; gap: 4px;">
                        <input type="checkbox" id="bilinear-fix">
                        <label for="bilinear-fix">Bilinear Fix</label>
                    </div>

                    <div style="display: flex; align-items: center; gap: 4px;">
                        <input type="checkbox" id="disable-mips">
                        <label for="disable-mips">Disable Mips</label>
                    </div>

                    <div style="display: flex; align-items: center; gap: 4px;">
                        <input type="checkbox" id="nonlinear-accumulation">
                        <label for="nonlinear-accumulation">Non-Linear Accumulation</label>
                    </div>

                    <div style="display: flex; align-items: center; gap: 4px">
                        <input type="checkbox" id="add-noise">
                        <label for="add-noise">Naive GI Noise</label>
                    </div>

                    <div style="display: none; align-items: center; gap: 4px">
                        <input type="checkbox" id="ringing-fix">
                        <label for="ringing-fix">Ringing Fix</label>
                    </div>

                    <div id="additional-controls-container">
                    </div>

                    <div style="display: flex; align-items: center; gap: 8px">BLOOM<input id="rc-sun-angle-slider" class="slider" type="range" min="0" max="6.2" step="0.1" value="2.0" />
                    </div>

                    <div style="display: flex; align-items: center; gap: 4px">
                        <input type="checkbox" id="reduce-demand">
                        <label for="reduce-demand">Reduce Demand (Calculate over 2 frames)</label>
                    </div>
                </details>
                <br />
                <div id="rc-canvas" ></div>
			</div>
		</div>
		<br>
		<br>
		<button id="ChyGe__GaZe">^<br>||</button>
		<br>
		<button id="ChyGe__GxZe"><==</button>
		<span> -|- </span>
		<button id="ChyGe__GxZo">==></button>
		<br>
		<button id="ChyGe__GaZo">||<br>v</button>
	</div>
	<br>
	<br>
	<div id="GAME_TEST" class="BOX">
		<h2>#4 GAME TEST</h2>
		<img style="position:center; width: calc(100% - 0.5em );" src="Mx01__SuKz_MEDIA/SuKz02_JaPo__PICT/JaPo__SF/SF_P00.png"></img>
		<br>
		<br>
		<!-- 2550, 1200 /5 = 510, 240 -->
		<canvas id="SF_KuGwy" width="1275" height="600" onclick="SF__KuGwy_DzNe"></canvas>
		<br>
		<br>
		<div style="display: flex; flex-direction: row;  justify-content: stretch; flex-wrap: wrap;" >
			<div class="CTRL_BOX" >
				<span id="SF_SaNoVaHx"></span>
			</div>
			<div class="CTRL_BOX" >
				<img id="SF_SaNoJaPo"; style="position:left;"></img>
			</div>
			<div class="CTRL_BOX" >
				<span id="SF_SaNoHaVu"></span>
			</div>
		</div>
		<br>
		<br>

		<!--  -->
		<canvas id="SF_KuSe" width="1000" height="1000" " onclick="SF__KuSe_DzNe" ></canvas>
		<br>
		<br>
		<div style="display: flex; flex-direction: row;  justify-content: space-between; flex-wrap: wrap;" >

				<div class="CTRL_BOX" >
					<h3 class="CTRL_LBL" title="Move in Scene"; >MOVE</h3>
					<button onclick="SF_ChyGe( -1, 1 );" title=""; >↖️</button>
					<button onclick="SF_ChyGe( 0, 1 );" title=""; >⬆️</button>
					<button onclick="SF_ChyGe( 1, 1 );" title=""; >↗️</button>
					<br>
					<button onclick="SF_ChyGe( -1, 0 );" title=""; >⬅️</button>
					<button onclick="SF_ChyGe( 0, 0 );" title=""; >⏺️</button>
					<button onclick="SF_ChyGe( 1, 0 );" title=""; >➡️</button>
					<br>
					<button onclick="SF_ChyGe( -1, -1 );" title=""; >↙️</button>
					<button onclick="SF_ChyGe( 0, -1 );" title=""; >⬇️</button>
					<button onclick="SF_ChyGe( 1, -1 );" title=""; >↘️</button>
				</div>

				<div class="CTRL_BOX" >
					<h3 class="CTRL_LBL" title="Use Items"; >USE</h3>
					<button onclick="SF_TraMo( TraMoKu.Punch.Vi, 1 );" title="Punch"; >👊</button>
					<button onclick="SF_TraMo( TraMoKu.Chop.Vi, 1 );" title="Chop"; >🪓</button>
					<button onclick="SF_TraMo( TraMoKu.Shoot.Vi, 1 );" title="Shoot"; >🔫</button>
					<br>
					<button onclick="SF_TraMo( TraMoKu.Heal.Vi, 1 );" title="Heal"; >💊</button>
					<button onclick="SF_TraMo( TraMoKu.Magnet.Vi, 1 );" title="Magnet"; >🧲</button>
					<button onclick="SF_TraMo( TraMoKu.Dig.Vi, 1 );" title="Dig"; >🪏</button>
					<br>
					<button onclick="SF_TraMo( TraMoKu.Flashlight.Vi, 1 );" title="Flashlight"; >🔦</button>
					<button onclick="SF_TraMo( TraMoKu.Bomb.Vi, 1 );" title="SmokeBomb"; >💣</button>
					<button onclick="SF_TraMo( TraMoKu.Alarm.Vi, 1 );" title="Alarm"; >🔊</button>
				</div>

			<div class="CTRL_BOX">
				<h3 class="CTRL_LBL" title="Communicate"; >COMZ</h3>
				<button onclick="SF_HraKe( HraKeKu.Say.Vi, 1 );" title="Say";>🗨️</button>
				<button onclick="SF_HraKe( HraKeKu.Yell.Vi, 1 );" title="Yell"; >🗯️</button>
				<button onclick="SF_HraKe( HraKeKu.Whisper.Vi, 1 );" title="Whisper"; >💭</button>
				<br>
				<button onclick="SF_HraKe( HraKeKu.Like.Vi, 1 );" title="LIKE"; >👍</button>
				<button onclick="SF_HraKe( HraKeKu.Wave.Vi, 1 );" title="WAVE"; >👋</button>
				<button onclick="SF_HraKe( HraKeKu.Dislike.Vi, 1 );" title="DISLIKE"; >👎</button>
				<br>
				<button onclick="SF_HraKe( HraKeKu.Search.Vi, 1 );" title=""; >👀</button>
				<button onclick="SF_HraKe( HraKeKu.Listen.Vi, 1 );" title=""; >👂</button>
				<button onclick="SF_HraKe( HraKeKu.Taste.Vi, 1 );" title=""; >👅</button>
			</div>

		</div>

		<br>
		<button id="MxHi"; onclick="HraBu_ChyMxHi();" style="display: block;">Use Fullscreen</button>
		<button id="MxDe"; onclick="HraBu_ChyMxDe();" style="display: none;">Use Window</button>

	</div>
	<br>
    <br>
    <div class="BOX">
        <h2>#5 LOG</h2>
        <div id="SmaDx" class="BUF"></div>
    </div>



    <script id="radiance-cascades-logic" src="Mx07__SuSmi_WEBPG/SuSmi01__JS/Kru03__Hrz2_Wy.js" type="application/javascript"></script>

</body>


<!-- ====================================================================== -->
<!-- Ku01 SCRIPT
<!-- ====================================================================== -->
<script>

    // @@@
	// QUAL
	const HraKeKu = Object.freeze
	({
		Say: { Vi: 0, Va: "Speak Message to Target" }
		, Yell: { Vi: 1, Va: "Yell Message to Target" }
		, Whisper: { Vi: 2, Va: "Whisper Message to Target" }

		, Like: { Vi: 3, Va: "Express Like of Target" }
		, Wave: { Vi: 4, Va: "Wave for Attention of Target" }
		, Dislike: { Vi: 5, Va: "Express Dislike of Target" }

		, Search: { Vi: 6, Va: "Yell Message to Target" }
		, Listen: { Vi: 7, Va: "Whisper Message to Target" }
		, Taste: { Vi: 8, Va: "Taste Item and Express to Target" }
	});

	const TraMoKu = Object.freeze
	({
		Punch: { Vi: 0, Va: "Punch Target if close" }
		, Chop: { Vi: 1, Va: "Chop at Target" }
		, Shoot: { Vi: 2, Va: "Fire Paintgun at Target" }

		, Heal: { Vi: 3, Va: "Consume Medicine" }
		, Magnet: { Vi: 4, Va: "Magnetize in a Direction" }
		, Dig: { Vi: 5, Va: "Dig with Shovel at Location" }

		, Flashlight: { Vi: 6, Va: "Toggle your Flashlight" }
		, Bomb: { Vi: 7, Va: "Toss 5 second Smoke-Bomb at Target" }
		, Alarm: { Vi: 8, Va: "Sound alarm" }
	});


    //======================================================================
    // Hro_Zz
    //======================================================================
	function clamp(number, lowerBound, upperBound)
	{
  		const clampedToLower = Math.max(number, lowerBound);
	  	const clampedToRange = Math.min(clampedToLower, upperBound);
  		return clampedToRange;
	}

	//@@@
	var Math_Random_Seed = 1972;
	function HrxGu_Vo_wfa()
	{
		var x = Math.sin( Math_Random_Seed++ ) * 10000;
		return x - Math.floor(x);
	}

	function HrxGuVo_wf( BraHi_wf ){ return ( HrxGu_Vo_wfa() * BraHi_wf ); }
	function HrxGuVo_wu( BraHi_wu ){ return ( Math.round( HrxGu_Vo_wfa() * BraHi_wu )); }

	function HrxGuVo__Grx_wf( BraHi_wf ){ return ( Math.random() * BraHi_wf ); }
	function HrxGuVo__Grx_wu( BraHi_wu ){ return ( Math.round( Math.random() * BraHi_wu )); }


    //======================================================================
    // DzDyKu
    //======================================================================

	//@@@
	// MAP
	const KuGry_BraHiGx = 51;
	const KuGry_BraHiGa = 24;
	const Ku_JaPo = new Image();

	let Gwx2 = (x,y,De) => [...Array( x )].map(_=>Array( y ).fill( De ));
	let JoDiKu = null;

	//@@@
	// SPRITES
	// 100px / Sqr
	const DzJy_TaFo_wuk = 18;
	const DzJy_TaJaPo = [];


	const DzDyKu =
	[
		{ Ka: 0, Va: "Flash", Jy: "Human Male A", DiHx: "Backstory: StarLaw Ranger Explorer Type" }
		, { Ka: 1, Va: "Dale", Jy: "Human Female B", DiHx: "Backstory: StarLaw Commander" }
		, { Ka: 2, Va: "Bobbb", Jy: "Dralasite B", DiHx: "Backstory: Seeker of Shiny Baubles" }
		, { Ka: 3, Va: "Slurrrp", Jy: "Dralasite C", DiHx: "Backstory: Ponderer of Deep Thoughts" }

		, { Ka: 4, Va: "Chittrz", Jy: "Vrusk A", DiHx: "Backstory: Never tell me the odds" }
		, { Ka: 5, Va: "ZyxFanx", Jy: "Vrusk B", DiHx: "Backstory: Calculating the odds..." }
		, { Ka: 6, Va: "Hemak", Jy: "Yazarian A", DiHx: "Backstory: Ready for battle rage" }
		, { Ka: 7, Va: "Conak", Jy: "Yazarian B", DiHx: "Backstory: Looking to bust some badguys" }

		, { Ka: 8, Va: "Sssam", Jy: "Sathar B", DiHx: "Backstory: Agent of reason" }
		, { Ka: 9, Va: "Sssue", Jy: "Sathar C", DiHx: "Backstory: Agent of deception" }
		, { Ka: 10, Va: "Arrrga", Jy: "Pirate Yazarian C", DiHx: "Backstory: Career Pirate by Family Tradition. Prefers hologames" }
		, { Ka: 11, Va: "Barrrba", Jy: "Pirate Dralasite D", DiHx: "Backstory: Pretending as a Pirate for a life purpose" }

		, { Ka: 12, Va: "Charka", Jy: "Pirate Vrusk B", DiHx: "Backstory: Take from the Rich and Give to the Poor" }
		, { Ka: 13, Va: "RuumBad", Jy: "Combat Robot", DiHx: "Backstory: Unstoppable War Machine" }
		, { Ka: 14, Va: "Copter-781", Jy: "Jet Copter", DiHx: "Backstory: Power Thrust but dangerously Vulnerable" }
		, { Ka: 15, Va: "Pod-321Go", Jy: "Work Pod", DiHx: "Backstory: Space Mech Vehicle" }

		, { Ka: 16, Va: "Screenie", Jy: "Masking Screen", DiHx: "Backstory: Screens prevent energy weapons" }
		, { Ka: 17, Va: "Fuego", Jy: "Fire", DiHx: "Backstory: Not a character as much as a phenomena to test" }
	];

	//@@@
	// SIM
	let JoDi_Gi = 1;
	// STARTING PLAYER
	let SaNo_DzDy = HrxGuVo__Grx_wu( DzDyKu.length - 1 );


    // @@@
	// COMZ
    const SPOKE_y = ( window.location.hash.length > 1 ) ? true : false;
    let HraBru;
    let HUB__Vy_vsg;
    let URL_HUB__Vy_vsg;


	// MAP_FAR
	// 2550 x 1200 @ 50px / Sqr
	const KuGwy_TiGyGx = 2550 * 0.5;
	const KuGwy_TiGyGa = 1200 * 0.5;
	const KuGwy_TiGyVu = 50 * 0.5;

	// LOC CLAMP
	const KuGwy_GeGyGx = KuGwy_TiGyGx / KuGwy_TiGyVu;
	const KuGwy_GeGyGa = KuGwy_TiGyGa / KuGwy_TiGyVu;


	// MAP_FOCUS
	// 500 x 500 @ 50px / Sqr
	// bigger = zoom out scene more
	// 0.55 = *2 = 11x11 sqr
	const KuSe__GyZy = 0.55;

	const KuSe_TiGyGx = 1000 * KuSe__GyZy;
	const KuSe_TiGyGa = 1000 * KuSe__GyZy;
	const KuSe_TiGyVu = 50 / KuSe__GyZy;
	const KuSe_GeGyGx = ( KuSe_TiGyGx / KuSe_TiGyVu ) / KuSe__GyZy;
	const KuSe_GeGyGa = ( KuSe_TiGyGa / KuSe_TiGyVu ) / KuSe__GyZy;


	//@@@
	// MSGS
	let Ta_VaVy_VaSy = new Map();

//	let Ta_KeDru = [ { "t": 0, "n": 0, "m": "Messages" } ];
	let Ta_KeDru = [ "Messages" ];
	let Ta_SmaDx = [ "Log" ];

    let JeKz__Fo_du = 0;
	let KeDru__GeZo_du = 0;
	let SmaDx__GeZo_du = 0;


    let GeGx = 128;
    let GeGa = 128;
	let GeKwe = 5;


	//@@@
    // APP TITLE
    document.getElementById( "VyBzVa" ).textContent += VER_vsg;

	//@@@
	// SHARE CTRLS
    document.getElementById( "Me_SHARE" ).style.display = (navigator.share) ? "block" : "none";


	//@@@
	// SCREENS
	// NOT _ALLOWED_
	// NotAllowedError: Transient activation is required to request permission.
	// HraBu_MzMxPo();


	//!!!
	// CLEAR LOCAL STORAGE
	// BraHi: 5 MiB
	// String ONLY
	// INSECURE
	// localStorage.clear();
	SmaDx( "Secure:", window.isSecureContext, " Online: ", navigator.onLine, " LocStore_Fo:", localStorage.length );


	//$$$
	// Sme
	// localStorage.debug = "HraBru";
	localStorage.removeItem( "debug" );


	//@@@
	// PAYMENT
	if ('getDigitalGoodsService' in window) { SmaDx( "The Digital Goods API is supported." ); }
	else { SmaDx( 'DigitalGoodsService is not available.' ); }


    // ======================================================================
    // ADR_BEGIN: HUB OR SPOKE
    // ======================================================================

    //@@@
    // SPOKE
    if ( SPOKE_y )
    {
		// ADR GEN
		// substr(1) skips the 'HASH SYMBOL' for PAGE TARGET
        let HUB__Vy_vsg = window.location.hash.substr( 1 ) || "bUH7ukDvd9R2xLLRKMKWZ1mGPkgdVfufye";
        HraBru = new HraBruKz( HUB__Vy_vsg );

		// ADR PUB
        URL_HUB__Vy_vsg = document.location.href;
        document.getElementById( "DuKu_VaSy" ).textContent = "#1 HUB Joined";
    }
	//@@@
	// HUB
    else
    {
        //&&&
        // SEED
        HraBru = new HraBruKz( { seed: localStorage[ "TaKeDru_VxYa" ] } );
        localStorage[ "TaKeDru_VxYa" ] = HraBru.seed;

        HUB__Vy_vsg = HraBru.seed;
        URL_HUB__Vy_vsg = document.location.href + "#" + HraBru.address();
        document.getElementById( "DuKu_VaSy" ).textContent = "#1 HUB Hosting";
    }

    // ======================================================================
    // ADR_END: SPOKE or HUB
    // ======================================================================

    //---------------------------
    // POST_ADR_INIT
    //---------------------------
    // SmaDx( " Fam: ", HraBru.localFamily, " Loc: ", HraBru.localAddress, " Rem: ", HraBru.remoteAddress );

	//@@@
	// PULSE ms
    HraBru.heartbeat( 12 * 1000 );


	//@@@
	// SELF NAME
    const SaNo_VaSy_l = document.getElementById( 'SaNo_VaSy' );
    SaNo_VaSy_l.value = localStorage.SaNo_VaSy ? localStorage.SaNo_VaSy : HraBru.address().slice( 0, 5 );

	Ta_VaVy_VaSy.set( HraBru.address, SaNo_VaSy_l.value );
	SmaDx( SPOKE_y ? "SPOKE@" : "HUB@", SaNo_VaSy_l.value );

	Mx_SaNo_VaSy();

	//@@@
	// MSG FOCUS
    const SaNo_MeKz_l = document.getElementById( 'SaNo_MeKz' );
    SaNo_MeKz_l.value = localStorage.SaNo_MeKz ? localStorage.SaNo_MeKz : "Test Message";
	SaNo_MeKz_l.focus();


	//@@@
	// SF
	SF_Ya();

    //---------------------------
    // EVT_SPOKES
	// Join or Exit
    //---------------------------
    function SPOKE__FoYy( count )
    {
        // HraBru.torrent.wires.length = count
		count += 1; // SERVER = +1
        document.getElementById( "KeDyCha" ).textContent = count ? "yes ( " + count + " )" : "no";
    }
	HraBru.on( "wireseen", SPOKE__FoYy );
    HraBru.on( "wireleft", SPOKE__FoYy );

	HraBru.on( "seen", function( adr )
	{
		// Use Initials to start
		Ta_VaVy_VaSy.set( adr, adr.slice( 0, 5 ) );

		SmaDx( "Spoke Join @ ", Ta_VaVy_VaSy.get( adr ) );

		let c = 0;
		for( let adr in Ta_VaVy_VaSy )
		{
			SmaDx( c, " = ", Ta_VaVy_VaSy.get( adr ) );
		}

	} );
	HraBru.on( "left", function( adr )
	{
		SmaDx( "Spoke Exit @ ", Ta_VaVy_VaSy.get( adr ) );
		Ta_VaVy_VaSy.delete( adr );
	} );


    //---------------------------
    // QR
    //---------------------------
    const qrCodeContainer = document.getElementById( 'QRDiv' );
    // Clear any existing QR code
    qrCodeContainer.innerHTML = '';
    // Create a new canvas element
    const canvas = document.createElement( 'canvas' );
    qrCodeContainer.appendChild( canvas );

    QRCode.toCanvas( canvas, URL_HUB__Vy_vsg,
    {
        width: 200,
        height: 200
    }, function( error )
    {
        if ( error )
        {
            console.error( error );
        }
    } );


    //---------------------------
	// AUDIO PLAY
    //---------------------------
	let ToMi_JaPe = document.getElementById( "ToMi_JaPe" );
	function ToMi_JaPe__Ya()
	{
		// SmaDx( "Aud" );
		ToMi_JaPe.play();
	}

	function ToMi_JaPe__Yi()
	{
		ToMi_JaPe.pause();
	}

	//---------------------------
	// SHARE HUB LINK
	//---------------------------
	document.getElementById( "Me_SHARE" ).onclick = function (evt )
	{
		if (navigator.share)
		{
			navigator.share(
			{
				title: 'Self_Serv Shared Link',
				text: 'To Join a Self_Serv Room, Click Here: ',
				url: URL_HUB__Vy_vsg,
				//----
				// CAN attach files ( JPG, OPUS, PDF, etc. )
				// files: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/share
			}).catch( err => { SmaDx( "Web Share API Failed:", err ); } );
		}

		//!!!
		// Vibrate 'SOS' in Morse for 200ms
		if( navigator.vibrate )
		{
			navigator.vibrate
			([
				100, 30, 100, 30, 100, 30, 200, 30, 200, 30, 200, 30, 100, 30, 100, 30, 100,
			]);
		}
	}

	document.getElementById( "Me_CLIP" ).onclick = function( evt )
	{
		copyToClipboard( URL_HUB__Vy_vsg );
		SmaDx( "Clip: ", URL_HUB__Vy_vsg );

		ToMi_JaPe__Ya();
	}

	document.getElementById( "Me_EMAIL" ).onclick = function( evt )
	{
		//content-type=text/html
		window.location.href = 'mailto:?subject=Self_Serv Shared Link&body=Open Room Link here:\n\n' + encodeURI( URL_HUB__Vy_vsg );
	}

	document.getElementById( "Me_SMS" ).onclick = function( evt )
	{
		window.location.href = 'sms:?body=Click Here: \n\n' + encodeURI( URL_HUB__Vy_vsg );
	}


    //---------------------------
    // EVT_SEND TXT NAME
    //---------------------------
	function Mx_SaNo_VaSy()
	{
		localStorage.SaNo_VaSy = SaNo_VaSy_l.value;

		// SmaDx( "Name Share^VaSy", SaNo_VaSy_l.value );

		let ChyNu_vsg_vbg = new TextEncoder();
		let SaNo_VaSy_vbg = ChyNu_vsg_vbg.encode( SaNo_VaSy_l.value );
		let SaNo_VaSy__Fo_du = SaNo_VaSy_vbg.length;


		// 4 bytes + 4pad + Fo
		const To_vbu = new ArrayBuffer( SaNo_VaSy__Fo_du + 8 );
		const JyNo = new DataView( To_vbu );

		// CMD
        JyNo.setUint8( 0, 0x1 );
        JyNo.setUint8( 1, 0x1 );
        JyNo.setUint8( 2, 0x1 );
        JyNo.setUint8( 3, 0x1 );

		for( let k = 0; k < SaNo_VaSy__Fo_du; k++ )
		{
			JyNo.setUint8( 4 +k, SaNo_VaSy_vbg[ k ] );
		}

		// TGT
		let SeVy = null;
		try{ HraBru.Me( SeVy, To_vbu ); }
		catch ( e ) { SmaDx( "Name Share FAILED", e ); }
	}


    //---------------------------
    // EVT_SEND TXT MSG
    //---------------------------
	function Mx_SaNo_MeKz( SeVx )
	{
		SmaDx( "MeKz:", SaNo_MeKz_l.value, " SeVx:", ( SeVx >= 0 ) ? SeVx : "ALL" );

		localStorage.SaNo_MeKz = SaNo_MeKz_l.value;

		let ChyNu_vsg_vbg = new TextEncoder();
		let SaNo_MeKz_vbg = ChyNu_vsg_vbg.encode( SaNo_MeKz_l.value );
		let SaNo_MeKz__Fo_du = SaNo_MeKz_vbg.length;

		// 4 bytes + 4pad + Fo
		const To_vbu = new ArrayBuffer( SaNo_MeKz__Fo_du + 8 );
		const JyNo = new DataView( To_vbu );

		// CMD
        JyNo.setUint8( 0, 0x2 );
        JyNo.setUint8( 1, 0x2 );
        JyNo.setUint8( 2, 0x2 );
        JyNo.setUint8( 3, 0x2 );

		for( let k = 0; k < SaNo_MeKz__Fo_du; k++ )
		{
			JyNo.setUint8( 4 +k, SaNo_MeKz_vbg[ k ] );
		}

		let SeVy = null;

		let i = 0;
		// ITER PEER ADR
		for( let adr in HraBru.peers )
		{
			if( i > SeVx ) break;
	  	 	// SmaDx( "Person[", i, "]: ", Ta_VaVy_VaSy.get( adr ) );

			SeVy = adr;
			i++;
		}

		//@@@
		// SEND
		try{ HraBru.Me( SeVy, To_vbu ); }
		catch ( e ) { SmaDx( "Msg Share FAILED", e ); }

		// CLEAR TXT & REFOCUS on TXT AREA!
		SaNo_MeKz_l.value = "";
		SaNo_MeKz_l.focus();
	}


    //---------------------------
    // EVT_SEND BRUSH
    //---------------------------
	function Mx_GeDri( GxVu, GaVu )
	{
		// SmaDx( "ChyGe__GxZo @ ", HraBru.Fe_vsg().toString() );
		let wrc = window.radianceCascades;

		const To_vbu = new ArrayBuffer( 16 );
		const JyNo = new DataView( To_vbu );

		// CMD
        JyNo.setUint8( 0, 0x3 );

		// VER
		JeKz__Fo_du++;
        JyNo.setUint8( 1, JeKz__Fo_du );

		// BRUSH SIZE
        JyNo.setUint16( 2, wrc.surface.RADIUS );

		// COLOR
		JyNo.setUint8( 4, wrc.surface.currentColor.r );
		JyNo.setUint8( 5, wrc.surface.currentColor.g );
		JyNo.setUint8( 6, wrc.surface.currentColor.b );
		JyNo.setUint8( 7, wrc.surface.currentColor.a );


		// LOC
		// SmaDx( "Me: GeYa x: ", GeGx, " y: ", GeGa );
		JyNo.setUint16( 8, GeGx );
		JyNo.setUint16( 10, GeGa );

        GeGx += GxVu;
        GeGa += GaVu;

		//SmaDx( "GeYi x: ", GeGx, " y: ", GeGa );
		JyNo.setUint16( 12, GeGx );
		JyNo.setUint16( 14, GeGa );

		//@@@
		// TGT
		let SeVy = null;
        try
        {
			// SeVy = null --> TO ALL, else --> KeDy
			HraBru.Me( SeVy, To_vbu );
        }
        catch ( e )
        {
            SmaDx( "Mx_GeDri FAILED", e );
        }
	}


    //---------------------------
    // ARROWS
    //---------------------------
    document.getElementById( "ChyGe__GxZo" ).onclick = function( evt )
    { Mx_GeDri( GeKwe, 0 ); }

    document.getElementById( "ChyGe__GxZe" ).onclick = function( evt )
    { Mx_GeDri( -GeKwe, 0 ); }

	document.getElementById( "ChyGe__GaZo" ).onclick = function( evt )
    { Mx_GeDri( 0, GeKwe ); }

    document.getElementById( "ChyGe__GaZe" ).onclick = function( evt )
    { Mx_GeDri( 0, -GeKwe ); }


	//---------------------------
    // MSG Ye
    //---------------------------
    function Mi_KeDru( adr, ChaKeDru )
    {
		//@@@
		// ADD STRING
		Ta_KeDru.push( ChaKeDru );

		// KEEP N items and track
		if( Ta_KeDru.length >= 64 ){ Ta_KeDru.splice( 0, 1 ); KeDru__GeZo_du++; }
		const KeDruFo = Ta_KeDru.length;


		let SmeDeKu = document.getElementById( "TaKeDru_Ku" );
		SmeDeKu.innerHTML = "<ul>";

		for (let i = 0; i < KeDruFo; i++)
		{
			let GwxVa = ( i + SmaDx__GeZo_du ).toString().padStart( 4, '0');
			SmeDeKu.innerHTML += "<li>" + GwxVa + "> "+ Ta_KeDru[i] + "</li>";
		}
		SmeDeKu.innerHTML += "</ul>";
    }


	//---------------------------
    // LOG YeYy
    //---------------------------
    function SmaDx()
    {
        let args = Array.prototype.slice.call( arguments );

        console.log.apply( null, args );
        args = args.map( function( a )
        {
            if ( typeof( a ) == "string" ) return a;
			if( typeof( a ) == "Gwx2" ) return ( JSON.stringify( a ).replace(/(\[\[)(.*)(\]\])/g,'[\n  [$2]\n]').replace(/],/g,'],\n ' ) );
            else return JSON.stringify( a );
        } );

		//@@@
		// ADD STRING
		Ta_SmaDx.push( args.join( " " ) );

		// KEEP N items and track
		if( Ta_SmaDx.length >= 64 ){ Ta_SmaDx.splice( 0, 1 ); SmaDx__GeZo_du++; }
		const KeDruFo = Ta_SmaDx.length;



		let SmeDeKu = document.getElementById( "SmaDx" );
		SmeDeKu.innerHTML = "<ul>";

		for( let i = KeDruFo - 1; i >= 0; i-- )
		{
			let GwxVa = ( i + SmaDx__GeZo_du ).toString().padStart( 4, '0');
			SmeDeKu.innerHTML += "<li>" + GwxVa + "> "+ Ta_SmaDx[i] + "</li>";
		}
		SmeDeKu.innerHTML += "</ul>";
    }


	//---------------------------
	// EVT_RECV
	//---------------------------
    HraBru.on( "Je", function( adr, To_vbu )
    {
		//@@@
		// PKT 'hasa'
        const JyNo = new DataView( To_vbu.buffer, To_vbu.offset, To_vbu.byteLength );
		const MoJy = JyNo.getUint8( 0 );

        switch ( MoJy )
        {
			//&&&
            // KEEP_ALIVE_PING
            case 0:
			break;

			//&&&
			// NAME UPDATE
			case 1:
			{
				const ChyNu_vbg_vsg = new TextDecoder('utf-8');
				const ChyNuKz = new DataView( To_vbu.buffer, To_vbu.offset + 4, To_vbu.byteLength - 4 );
				const VaSy_vsg = ChyNu_vbg_vsg.decode( ChyNuKz );

				if( VaSy_vsg === undefined )
				{
					SmaDx( "Got CORRUPTED NAME" );
				}
				else
				{
					Ta_VaVy_VaSy.set( adr, VaSy_vsg );
					SmaDx( "Got NAME[ ",  Ta_VaVy_VaSy.get( adr ), " ]: ", VaSy_vsg );
				}
			}
			break;


			//&&&
			// MSG SYNC
			case 2:
			{
				const ChyNu_vbg_vsg = new TextDecoder('utf-8');
				const ChyNuKz = new DataView( To_vbu.buffer, To_vbu.offset + 4, To_vbu.byteLength - 4 );
				const KeDru_vsg = ChyNu_vbg_vsg.decode( ChyNuKz );

				Mi_KeDru( adr, KeDru_vsg );

				SmaDx( "Got MSG[ ", Ta_VaVy_VaSy.get( adr ), " ]: ", KeDru_vsg );
			}
			break;


			//&&&
			// BRUSH
            case 3:
			{
				let wrc = window.radianceCascades;

				// JyNo.getUint8( 1 );

				// Brush Size
				let DriGy_su = JyNo.getUint16( 2 );
				wrc.radiusSlider.onUpdate( DriGy_su );

				// COLOR
				//let Po_wu = JyNo.getUint32( 4 );
				//const Po_hex = "#" + Po_wu.toString(16).toUpperCase().padStart( 7, '0');
				wrc.setTint( JyNo.getUint8( 4 ), JyNo.getUint8( 5 ), JyNo.getUint8( 6 ), JyNo.getUint8( 7 ) );

				// LOC
				let GeYa =
				{
					x: JyNo.getUint16( 8 ),
					y: JyNo.getUint16( 10 )
				};

				let GeYi =
				{
					x: JyNo.getUint16( 12 ),
					y: JyNo.getUint16( 14 )
				};

				//SmaDx( "MiJe_BRUSH[ ", Ta_VaVy_VaSy.get( adr ), " ]" );
				// SmaDx( "MiJe_BRUSH[ ", Ta_VaVy_VaSy.get( adr ), " ] GeYa:", GeYa, " GeYi:", GeYi, " DriGy:", DriGy_hex, " Po:", Po_hex );

				return new Promise( ( resolve ) =>
				{
					// wrc.setHex( "#FFAA00FF" );
					wrc.surface.drawSmoothLine( GeYa, GeYi );
				} )
				.then( () =>
				{
				wrc.isDrawing = false;
				wrc.renderPass();
				requestAnimationFrame();
				} );

				break;
			}


			//&&&
			// SCENE COMZ
            case 4:
			{


				break;
			}

			//&&&
			// SCENE MOVE
            case 5:
			{
				const DzDy_su = JyNo.getUint16( 2 );

				Dz_l = DzDyKu[ DzDy_su ];

				Dz_l.x = JyNo.getUint16( 4 );
				Dz_l.y = JyNo.getUint16( 6 );

				Dz_l.Se_DzDy = JyNo.getUint16( 8 );

				SF_Ye();

				break;
			}

			//&&&
			// SCENE USE
            case 6:
			{



				break;
			}



        }// END SWITCH


    } );


   // ======================================================================
    // KEYS
    // ======================================================================
	document.addEventListener( "keydown", ( e ) =>
	{
		switch (e.key)
		{
			case "ArrowLeft":
				// Left pressed
				SF_ChyGe( -1, 0 );
				break;
				case "ArrowRight":
					// Right pressed
					SF_ChyGe( 1, 0 );
				break;
				case "ArrowUp":
					// Up pressed
				SF_ChyGe( 0, 1 );
				break;
			case "ArrowDown":
				// Down pressed
				SF_ChyGe( 0, -1 );
				break;

			//$$$
			// LOG
			// default: SmaDx( "Key:", e.code );

		}// END SWITCH

	});

   // ======================================================================
    // SCREEN
    // ======================================================================
	// NEEDS to be called directly from USER input event?
	async function HraBu_MzMxPo()
	{
		if( window.getScreenDetails )
		{
			const screenDetails = await window.getScreenDetails();

			// Open a window on each screen of the device
			for (const screen of screenDetails.screens)
			{
				SmaDx
				( "Screen: ",
					screen.label,
					screen.availLeft,
					screen.availTop,
					screen.availWidth,
					screen.availHeight,

					"Primary: ",
					screen.isPrimary,
					"Internal: ",
					screen.isInternal,
				);
			}
		}
	}


	function HraBu_ChyMxHi()
	{
		var elem = document.getElementById('GAME_TEST' );
		if(elem.requestFullscreen)
		{
			elem.requestFullscreen();
			 document.getElementById( "MxHi" ).style.display = "none";
			 document.getElementById( "MxDe" ).style.display = "block";
		}
	}
	function HraBu_ChyMxDe()
	{
		if(document.exitFullscreen)
		{
			document.exitFullscreen();
			document.getElementById( "MxHi" ).style.display = "block";
			 document.getElementById( "MxDe" ).style.display = "none";
		}
	}

    // ======================================================================
    // TEXT
    // ======================================================================
	function printAtWordWrap( HrySx , text, x, y, lineHeight, fitWidth)
	{
		fitWidth = fitWidth || 0;

		if (fitWidth <= 0)
		{
			HrySx.fillText( text, x, y );
			return;
		}
		var words = text.split(' ');
		var currentLine = 0;
		var idx = 1;
		while (words.length > 0 && idx <= words.length)
		{
			var str = words.slice(0,idx).join(' ');
			var w = HrySx.measureText(str).width;
			if ( w > fitWidth )
			{
				if (idx==1)
				{
					idx=2;
				}
				HrySx.fillText( words.slice(0,idx-1).join(' '), x, y + (lineHeight*currentLine) );
				currentLine++;
				words = words.splice(idx-1);
				idx = 1;
			}
			else
			{idx++;}
		}
		if  (idx > 0)
			HrySx.fillText( words.join(' '), x, y + (lineHeight*currentLine) );
	}

	function drawStroked( HrySx, KeDruDri_vsg, x, y )
	{
		HrySx.font = '32px Sans-serif';
		HrySx.textAlign = "center";
  		HrySx.textBaseline = "middle";

		let KeDruHa = HrySx.measureText( KeDruDri_vsg );
		// SmaDx( "KeDruHa: ", KeDruHa.width, KeDruHa.emHeightAscent, KeDruHa.emHeightDescent);

		HrySx.lineWidth = 6;

    	HrySx.lineJoin="miter"; //Experiment with "bevel" & "round" for the effect you want!
		HrySx.miterLimit=2;

		HrySx.strokeStyle = 'black';
		HrySx.strokeText( KeDruDri_vsg, x, y);

		HrySx.fillStyle = "#FFFF00FF";

		HrySx.fillText( KeDruDri_vsg, x, y);
	}


    // ======================================================================
    // SF_Chy
    // ======================================================================

	//@@@
	// COMZ
	function SF_HraKe( Jy, Vu )
	{
		// SmaDx( "HraKe:", HraKeKu, "Jy", Jy );
		const HraKeJy = Object.values( HraKeKu )[ Jy ];
		SmaDx( "Comz:", HraKeJy.Va );
	}

	//@@@
	// USE
	function SF_TraMo( Jy, Vu )
	{
		// SmaDx( "Use:", Jy, Vu );
		const TraMoJy = Object.values( TraMoKu )[ Jy ];
		SmaDx( "Use:", TraMoJy.Va );
	}

	//@@@
	// MOVE
	function SF_ChyGe( Gx, Ga )
	{
		const DzDy_l = DzDyKu[ SaNo_DzDy ];

		if( ( JoDiKu[ DzDy_l.x + Gx ][ DzDy_l.y + Ga ] == -1 ))
		{
			// SmaDx( "SF_ChyGe", Gx, Ga, KuGwy_GeGyGx, KuGwy_GeGyGa );
			DzDy_l.x += Gx;
			DzDy_l.y -= Ga;

			DzDy_l.x = clamp( DzDy_l.x, 0, KuGwy_GeGyGx -1 );
			DzDy_l.y = clamp( DzDy_l.y, 0, KuGwy_GeGyGa -1 );
			// SmaDx( "SF_ChyGe", DzDy_l.x, DzDy_l.y, KuGwy_GeGyGx, KuGwy_GeGyGa );
		}

		//&&&
		// SEND
		{
			const To_vbu = new ArrayBuffer( 16 );
			const JyNo = new DataView( To_vbu );

			// CMD
        	JyNo.setUint8( 0, 5 );

			// THING
        	JyNo.setUint16( 2, SaNo_DzDy );

			// LOC
        	JyNo.setUint16( 4, DzDy_l.x );
        	JyNo.setUint16( 6, DzDy_l.y );

			JyNo.setUint16( 8, DzDy_l.Se_DzDy );


			//%%%
			// SEND
			//  SmaDx( "Move", DzDy_l.x, DzDy_l.y );
			let SeVy = null;
			try{ HraBru.Me( SeVy, To_vbu ); }
			catch ( e ) { SmaDx( "MOVE FAILED", e ); }
		}


		//@@@
		// UPDATE
		SF_Ye();
	}

    // ======================================================================
    // SF_DzNe
    // ======================================================================
	document.getElementById( "SF_KuGwy" ).addEventListener( "click", ( e ) => SF__KuGwy_DzNe( ( e.clientX ), ( e.clientY ) ) );

	function SF__KuGwy_DzNe( x, y )
	{
		const KuGwyKz = document.getElementById( 'SF_KuGwy' );
		const Kwi = KuGwyKz.getBoundingClientRect();

		// KuGwy_GeGyGx
		x = Math.floor( ( x - Kwi.left ) / ( Kwi.right - Kwi.left + 1 ) * KuGwy_GeGyGx );
		y = Math.floor( ( y - Kwi.top ) / ( Kwi.bottom - Kwi.top + 1 ) * KuGwy_GeGyGa );
		// SmaDx( "Scene FAR Pick:", x, y );

		DzDyKu.forEach(( DzDy_l, Vx ) =>
		{
			if( ( x === DzDy_l.x ) && ( y === DzDy_l.y ) )
			{
				if( SaNo_DzDy !== Vx )
				{
					// PRV TGT is 'NEW' PICK
					// DzDyKu[ SaNo_DzDy ].Se_DzDy = Vx;
					DzDyKu[ Vx ].Se_DzDy = -1;
					SaNo_DzDy = Vx;
					// UPDATE
					SF_ChyGe( 0, 0 );
				}
				return;
			}
		}); // FOR EACH THING

	}

	document.getElementById( "SF_KuSe" ).addEventListener( "click", ( e ) =>SF__KuSe_DzNe( ( e.clientX ), ( e.clientY ) ) );

	function SF__KuSe_DzNe( x, y )
	{
		const KuSeKz = document.getElementById( 'SF_KuSe' );
		const Kwi = KuSeKz.getBoundingClientRect();

		x = Math.floor( ( x - Kwi.left ) / ( Kwi.right - Kwi.left + 1 ) * KuSe_GeGyGx );
		y = Math.floor( ( y - Kwi.top ) / ( Kwi.bottom - Kwi.top + 1 ) * KuSe_GeGyGa );
		// SmaDx( "Scene NEAR Pick:", x, y );

		DzDyKu.forEach(( DzDy_l, Vx ) =>
		{
			if( ( x === DzDy_l.x ) && ( y === DzDy_l.y ) )
			{
				if( SaNo_DzDy !== Vx )
				{
					// PRV TGT is 'NEW' PICK
					// DzDyKu[ SaNo_DzDy ].Se_DzDy = Vx;
					DzDyKu[ Vx ].Se_DzDy = -1;
					SaNo_DzDy = Vx;
					// UPDATE
					SF_ChyGe( 0, 0 );
				}
				return;
			}
		}); // FOR EACH THING

	}

    // ======================================================================
    // SF_Bri
    // ======================================================================
	async function SF_Ya()
	{
		// LOAD MAP
		Ku_JaPo.src = "Mx01__SuKz_MEDIA/SuKz02_JaPo__PICT/JaPo__SF/SF_M00.png";

		// LOAD SPRITES
		for( let k = 0; k < DzJy_TaFo_wuk; k++ )
		{
			const JaPo = new Image();
			JaPo.src = "Mx01__SuKz_MEDIA/SuKz02_JaPo__PICT/JaPo__SF/SF_C" + k.toString().padStart( 2, '0' ) + ".png";
			DzJy_TaJaPo.push( JaPo );
		}

		// WAIT TILL ALL DONE
		for( let k = 0; k < DzJy_TaFo_wuk; k++ )
		{
			const JaPo = DzJy_TaJaPo[ k ];
			await JaPo.decode();
		}
		await Ku_JaPo.decode();

		// INIT CHARS
		DzDyKu.forEach(( DzDy_l, Vx ) =>
		{
			DzDy_l.x = HrxGuVo_wu( KuGry_BraHiGx -1 );
			DzDy_l.y = HrxGuVo_wu( KuGry_BraHiGa -1 );

			DzDy_l.x = HrxGuVo_wu( 10 -1 );
			DzDy_l.y = HrxGuVo_wu( 10 -1 );


			DzDy_l.STR_STA = 5 * ( 6 + HrxGuVo_wu( 12 ));
			DzDy_l.DEX_RS =  5 * ( 6 + HrxGuVo_wu( 12 ));
			DzDy_l.INT_LOG =  5 * ( 6 + HrxGuVo_wu( 12 ));
			DzDy_l.PER_LDR =  5 * ( 6 + HrxGuVo_wu( 12 ));

			DzDy_l.Se_DzDy = HrxGuVo_wu( DzDyKu.length - 1 );
			if( DzDy_l.Se_DzDy === Vx ){ DzDy_l.Se_DzDy = -1; }

		}); // FOR EACH THING


		// CLEAR FIRST CONTROLLED PLAYER TGT
		DzDyKu[SaNo_DzDy ].Se_DzDy = -1;

		/// FILL IN MAP OCCUPANCY
		SF_Ye();

		// BROADCAST to OTHERS
		SF_ChyGe( 0, 0 );
	}

	function SF_Ye()
	{
		//===========================================
		// SIM
		//===========================================

		//@@@
		// SIM-TURN-STEP
		JoDi_Gi++;

		//@@@
		// SELF
		const SaNo__DzDy_l = DzDyKu[ SaNo_DzDy ];
		//console.log(JSON.stringify(m).replace(/(\[\[)(.*)(\]\])/g,'[\n  [$2]\n]').replace(/],/g,'],\n ' ) );

		JoDiKu = Gwx2( KuGry_BraHiGx, KuGry_BraHiGa, -1 );


		DzDyKu.forEach(( DzDy_l, Vx ) =>
		{
			JoDiKu[ DzDy_l.x ][ DzDy_l.y ] = Vx;
		}); // FOR EACH THING


		DzDyKu.forEach(( DzDy_l, Vx ) =>
		{
			const Se_Vy = DzDy_l.Se_DzDy;

			if( Se_Vy != -1 )
			{
				const Se_DzDy_x = DzDyKu[ Se_Vy ].x;
				const Se_DzDy_y = DzDyKu[ Se_Vy ].y;

				let Zo_x = ( DzDy_l.x < Se_DzDy_x ) ? 1 : ( ( DzDy_l.x > Se_DzDy_x )  ? -1 : 0 );
				let Zo_y = ( DzDy_l.y < Se_DzDy_y ) ? 1 : ( ( DzDy_l.y > Se_DzDy_y )  ? -1 : 0 );

				// ONLY IF TGT EMPTY!
				if( ( JoDiKu[ DzDy_l.x + Zo_x ][ DzDy_l.y + Zo_y ] == -1 ))
				{
					DzDy_l.x += Zo_x;
					DzDy_l.y += Zo_y;
					JoDiKu[ DzDy_l.x ][ DzDy_l.y ] = Vx;
				}
				// TRY X
				else if( ( JoDiKu[ DzDy_l.x + Zo_x ][ DzDy_l.y ] == -1 ))
				{
					DzDy_l.x += Zo_x;
					JoDiKu[ DzDy_l.x ][ DzDy_l.y ] = Vx;
				}
				// TRY Y
				else if( ( JoDiKu[ DzDy_l.x ][ DzDy_l.y + Zo_y ] == -1 ))
				{
					DzDy_l.y += Zo_y;
					JoDiKu[ DzDy_l.x ][ DzDy_l.y ] = Vx;
				}


			}

		}); // FOR EACH THING


		// SmaDx( "Ge:", DzGwy_GeGyGx, DzGwy_GeGyGa, DzSe_GeGyGx, DzSe_GeGyGa );

		// SmaDx( JoDiKu.slice( 0, 8 ) );

		//===========================================
		// RENDER
		//===========================================

		//@@@
		// SPATIAL SESSION
		const KuGwyKz = document.getElementById( 'SF_KuGwy' );
		const KuSeKz = document.getElementById( 'SF_KuSe' );

		const KuGwyKz_HrySx = KuGwyKz.getContext( '2d' );
		const KuSeKz_HrySx = KuSeKz.getContext( '2d' );


		//@@@
		// GLOBAL MAP
		// SmaDx( "CANVAS", Ku_JaPo.width, Ku_JaPo.height, KuGwyKz.width, KuGwyKz.height );
		KuGwyKz_HrySx.drawImage( Ku_JaPo, 0, 0, Ku_JaPo.width, Ku_JaPo.height, 0, 0, KuGwyKz.width, KuGwyKz.height );


		//@@@
		// FOCUS MAP
		SaNoGeZoGxYa = KuSe_TiGyVu * clamp( SaNo__DzDy_l.x - 5, 0, KuGry_BraHiGx - 1 );
		SaNoGeZoGaYa = KuSe_TiGyVu * clamp( SaNo__DzDy_l.y - 5, 0, KuGry_BraHiGa - 1 );

		SaNoGeZoGxYi = KuSe_TiGyVu * clamp( SaNo__DzDy_l.x + 5, 0, KuGry_BraHiGx - 1 );
		SaNoGeZoGaYi = KuSe_TiGyVu * clamp( SaNo__DzDy_l.y + 5, 0, KuGry_BraHiGa - 1 );


		SmaDx( "Slider LOC", SaNo__DzDy_l.x, SaNo__DzDy_l.y );
		SmaDx( "Slider CANVAS", SaNoGeZoGxYa, SaNoGeZoGxYi, SaNoGeZoGaYa, SaNoGeZoGaYi );

		SaNoGeZoGxYa = 0;
		SaNoGeZoGaYa = 0;

		SaNoGeZoGxYi = KuSe_TiGyGx;
		SaNoGeZoGaYi = KuSe_TiGyGa;

		KuSeKz_HrySx.drawImage( Ku_JaPo, SaNoGeZoGxYa, SaNoGeZoGaYa, SaNoGeZoGxYi, SaNoGeZoGaYi, 0, 0, KuSeKz.width, KuSeKz.height );


		//&&&
		// OPC_MIX
		// https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation

		//&&&
		// UNITS
		const DzGwy_BraHiGx = KuGwyKz.width / KuGwy_TiGyVu;
		const DzGwy_BraHiGa = KuGwyKz.height / KuGwy_TiGyVu;

		const DzSe_BraHiGx = KuSeKz.width / KuSe_TiGyVu;
		const DzSe_BraHiGa = KuSeKz.height / KuSe_TiGyVu;

		const DzGwy_GeGyGx = KuGwy_TiGyVu;
		const DzGwy_GeGyGa = KuGwy_TiGyVu;

		const DzSe_GeGyGx = KuSe_TiGyVu;
		const DzSe_GeGyGa = KuSe_TiGyVu;


		//&&&
		// SPRITE per PLAYER
		// KuSeKz_HrySx.globalAlpha = 0.5;
		KuSeKz_HrySx.globalCompositeOperation = "multiply";

		DzDyKu.forEach(( DzDy_l, Vx ) =>
		{
			const Fe_JaPo = DzJy_TaJaPo[ Vx ];

			// GLOBAL MAP: Draw ALL
			KuGwyKz_HrySx.drawImage( Fe_JaPo, 0, 0, Fe_JaPo.width, Fe_JaPo.height, DzDy_l.x * DzGwy_GeGyGx, DzDy_l.y * DzGwy_GeGyGa, DzGwy_GeGyGx, DzGwy_GeGyGa );

			// FOCUS MAP: Draw LIMITED
			KuSeKz_HrySx.drawImage( Fe_JaPo, 0, 0, Fe_JaPo.width, Fe_JaPo.height, DzDy_l.x * DzSe_GeGyGx, DzDy_l.y * DzSe_GeGyGa, DzSe_GeGyGx, DzSe_GeGyGa );

			// SmaDx( "Ge:", DzGwy_GeGyGx, DzGwy_GeGyGa, DzSe_GeGyGx, DzSe_GeGyGa );

		}); // FOR EACH THING

		KuSeKz_HrySx.globalCompositeOperation = "source-over";


		//@@@
		// TXT for SELF
		{
			let KeDruDri_vsg = "Turn #" + JoDi_Gi + " ☢️";
			drawStroked( KuGwyKz_HrySx, KeDruDri_vsg, KuGwyKz.width / 2, KuGwyKz.height / 2 );
		}

		//@@@
		// STATS

		document.getElementById( 'SF_SaNoVaHx' ).innerHTML =
		"CHARACTER DATA"
		+ "<br>Name: " + SaNo__DzDy_l.Va
		+ "<br>Race: " + SaNo__DzDy_l.Jy
		+ "<br>ID: " + SaNo__DzDy_l.Ka
		+ "<br>Tgt: " + ( ( SaNo__DzDy_l.Se_DzDy === -1 )? "None" : DzDyKu[ SaNo__DzDy_l.Se_DzDy ].Va )
		+ "<br>Details: " + SaNo__DzDy_l.DiHx
		;

		document.getElementById( 'SF_SaNoJaPo' ).src = DzJy_TaJaPo[ SaNo_DzDy ].src;

		document.getElementById( 'SF_SaNoHaVu' ).innerHTML =
		"PHYSICAL DATA"
		+ "<br>STR/STA: " + SaNo__DzDy_l.STR_STA
			+ "<br>DEX/RS: " + SaNo__DzDy_l.DEX_RS
			+ "<br>INT/LOG: " + SaNo__DzDy_l.INT_LOG
			+ "<br>PER/LDR: " + SaNo__DzDy_l.PER_LDR
			+ "<br>Loc: " + SaNo__DzDy_l.x + ", " + SaNo__DzDy_l.y

	}



</script>


<!-- ====================================================================== -->
<!-- END
 <!-- ====================================================================== -->

</html>

<!-- ====================================================================== -->
<!-- ToKzYi -->
<!-- ====================================================================== -->
